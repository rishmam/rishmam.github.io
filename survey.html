<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="google-signin-client_id" content="287779324897-bhjpqlec48lt942qe0qsu5f5st023rj5.apps.googleusercontent.com">
  <script src="https://apis.google.com/js/platform.js" async defer></script>

	<!-- add bootstrap css file -->
  <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="css/main.css">

</head>

</body>
    <!-- navbar -->
    <nav class="navbar navbar-expand-lg fixed-top ">
      <a class="navbar-brand" href="./homepage.html">
        <img src="/images/start_logo.png" width="40" height="40" alt="">
      </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <a class="navbar-brand" href="./homepage.html">
        <ul class="navbar-nav mr-4">
          <li class="nav-item">
            <div class="start">
              <button class="button4" id="demo" onclick="window.location.href = 'https://nehana.github.io/login.html';"></button>
              <script>
              var countDownDate = new Date("Feb 10, 2020 23:59:59").getTime();
              var x = setInterval(function() {
              var now = new Date().getTime();
              var distance = countDownDate - now;
              var days = Math.floor(distance / (1000 * 60 * 60 * 24));
              if (days < 10) {
                days = "0" + days;
              }
              var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
              if (hours < 10) {
                hours = "0" + hours;
              }
              var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
              if (minutes < 10) {
                minutes = "0" + minutes;
              }
              var seconds = Math.floor((distance % (1000 * 60)) / (1000));
              if (seconds < 10) {
                seconds = "0" + seconds;
              }
              document.getElementById("demo").innerHTML = days + " : " + hours + " : "
              + minutes + " : " + seconds;
              if (distance < 0) {
                clearInterval(x);
                document.getElementById("demo").innerHTML = "Happy Valentine's Day!!";
              }
              }, 1000);
              </script>
            </div>
          </li>
        </ul>
      </a>
      <div class="collapse navbar-collapse " id="navbarSupportedContent">
        <ul class="navbar-nav mr-4">
            <li class="nav-item">
              <a class="nav-link" href="./about2.html">ABOUT</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./team.html">TEAM</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./faq2.html">FAQ</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="login" href="./login.html">LOGIN</a>
            </li>
        </ul>
        <script>
          const checkAuth = async() => {
            console.log(sessionStorage.email);
            if(sessionStorage.email == undefined) {
              console.log("user not logged in");
              var element = document.getElementById("login");
              element.innerHTML = "LOGIN";
              element.setAttribute('href', './login.html');
              return;
            } else { 
              console.log("user logged in");
              var element = document.getElementById("login");
              element.innerHTML = "LOG OUT";
              element.setAttribute('href', './logoutConfirmation.html');
              return;
            }
          }
          function signOut() {
            gapi.auth2.getAuthInstance().signOut().then(function() {
              console.log('user signed out');
              var element = document.getElementById("login");
              element.innerHTML = "LOGIN";
              element.setAttribute('href', './login.html');
              sessionStorage.clear();
              window.location.replace("https://nehana.github.io/logoutConfirmation.html");
              return;
            })
          }
        </script>
      </div>
    </nav>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"> 
    <title>BearPairs Survey</title> 
    <style type="text/css"> html{ margin: 0; height: 100%; overflow: hidden; } iframe{ position: absolute; left:0; right:0; bottom:0; top:0; border:0; } </style> 
    <body onload = "checkAuth()"> 
    <iframe id="typeform-full" width="100%" height="100%" frameborder="0" src="https://bearpairsmarketing.typeform.com/to/b2bvmq"></iframe> 
    <script type="text/javascript" src="https://embed.typeform.com/embed.js"></script> 
    <script src="https://www.gstatic.com/firebasejs/5.5.8/firebase.js"></script>
    <script>
      // Initialize Firebase
      var config = {
          apiKey: "AIzaSyCvpEisytGcXdAqjyxrWiDrAvqy86Bi6Dk",
          authDomain: "bearp-493dc.firebaseapp.com",
          databaseURL: "https://bearp-493dc.firebaseio.com",
          projectId: "bearp-493dc",
          storageBucket: "bearp-493dc.appspot.com",
          messagingSenderId: "714702346867"
      }
      firebase.initializeApp(config);
    </script>
    <script>
      const checkAuth = async() => {
        const userEmail = sessionStorage.email;
        const db = firebase.firestore();

        const users = db.collection('users');
            const res = await getUser();
            console.log(res);
        };

        const getUser = async () => {
            const userEmail = sessionStorage.email;
            if (sessionStorage.email == undefined) {
              console.log(sessionStorage.email + " is undefined");
              window.location.replace("http://nehana.github.io/loginFailure.html");
              var element = document.getElementById("typeform-full");
              element.parentNode.removeChild(element);
              return;
            }
            else if(sessionStorage.email.substring(sessionStorage.email.length - 12, sessionStorage.email.length) != "berkeley.edu"){
              console.log(sessionStorage.email + " Not valid login");
              console.log(sessionStorage.email.substring(sessionStorage.email.length - 12, sessionStorage.email.length) != "berkeley.edu");
              window.location.replace("http://nehana.github.io/loginFailure.html");
              var element = document.getElementById("typeform-full");
              element.parentNode.removeChild(element);
              return;
            }
            const db = firebase.firestore();
            const users = db.collection('users');
            const querySnapshot = await users.get();
            const docSnapshots = querySnapshot.docs;
            let list = [];
            for (var i in docSnapshots) {
              if (docSnapshots[i].data().email == (sessionStorage.email)) {
                console.log(docSnapshots[i].data().email);
                list.push({email: docSnapshots[i].data().email, name: docSnapshots[i].data().name, picture: docSnapshots[i].data().picture, tweet: docSnapshots[i].data().tweet});
                window.location.replace("http://nehana.github.io/matches.html");
                break;
              }
            }
            console.log("Login not in db");
            return list;
        }
  </script>
  
  
    </body> 
</html>

<html> <head> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"> <title>BearPairs survey (updated)</title> <style type="text/css"> html{ margin: 0; height: 100%; overflow: hidden; } iframe{ position: absolute; left:0; right:0; bottom:0; top:0; border:0; } </style> </head> <body> <iframe id="typeform-full" width="100%" height="100%" frameborder="0" src="https://rebrand.ly/bearpairs"></iframe> <script type="text/javascript" src="https://embed.typeform.com/embed.js"></script> </body> </html>
